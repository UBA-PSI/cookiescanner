The cookiebanner result dictionary
==================================

Like Privacyscanner, the cookiebanner modules stores its result in a large JSON object.

The current dictionary format
-----------------------------

+---------------------------------------+-----------------------------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------+
| Key                                   | Type                        | Scan module  | Remarks                                                                                                                                 |
+=======================================+=============================+==============+=========================================================================================================================================+
| BANNER_PRESENT_WITHOUT_TRACKING       | boolean                     | cookiebanner | Boolean that is set when a cookie banner is present wihtout any detected tracking                                                       |
+---------------------------------------+-----------------------------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------+
| BUTTONS_HAVE_DIFFERENT_COLOR          | boolean                     | cookiebanner | Boolean that is set when the identified buttons have a different color                                                                  |
+---------------------------------------+-----------------------------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------+
| TRACKING_BEFORE_ANY_ACTION            | boolean                     | cookiebanner | Boolean that is set when tracking occurs before any user interaction                                                                    |
+---------------------------------------+-----------------------------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------+
| cookie_notice_count                   | dict(str:int)               | cookiebanner | A dictionary containing the total number of detected cookie banners per detection method. e. g. {'filter_list': 2, ...}                 |
+---------------------------------------+-----------------------------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------+
| cookie_syncs                          | list[COOKIE_SYNC]           | cookiebanner | List of identified cookie synchronizations                                                                                              |
+---------------------------------------+-----------------------------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------+
| cookie_syncs_num                      | int                         | cookiebanner | Number of idnetified cookie synchronizations                                                                                            |
+---------------------------------------+-----------------------------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------+
| cookies                               | list[COOKIE]                | cookiebanner | List of all saved cookies                                                                                                               |
+---------------------------------------+-----------------------------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------+
| disconnect                            | list[DISCONNECT_REQUEST]    | cookiebanner | List of requests matching the "Disconnect" list                                                                                         |
+---------------------------------------+-----------------------------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------+
| disconnect_num                        | int                         | cookiebanner | Number of requests identified as trackers by the "Disconnect" list                                                                      |
+---------------------------------------+-----------------------------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------+
| filter_list                           | int                         | cookiebanner | Detection result for filter_list detection module                                                                                       |
+---------------------------------------+-----------------------------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------+
| naive                                 | int                         | cookiebanner | Detection result for naive detection module                                                                                             |
+---------------------------------------+-----------------------------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------+
| perceptive                            | int                         | cookiebanner | Detection result for perceptive detection module                                                                                        |
+---------------------------------------+-----------------------------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------+
| preferred_detector                    | int                         | cookiebanner | The detection method that is used to click through the banner                                                                           |
+---------------------------------------+-----------------------------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------+
| privacy_policy                        | dict(PRIVACY_POLICY)        | cookiebanner | The privacy if one has been detected in the banner                                                                                      |
+---------------------------------------+-----------------------------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------+
| privacy_policy_present                | int                         | cookiebanner | Boolean that is set if a privacy policy is detected                                                                                     |
+---------------------------------------+-----------------------------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------+
| screenshots                           | dict(str:list[str])         | cookiebanner | Dict with base64 coded screenshots for each detection method                                                                            |
+---------------------------------------+-----------------------------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------+
| site_url                              | str                         | cookiebanner | The name of the website that is currently being scanned                                                                                 |
+---------------------------------------+-----------------------------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------+
| total_tracker_num                     | int                         | cookiebanner | Total count of detected trackers (disconnect_num + cookie_syncs_num)                                                                    |
+---------------------------------------+-----------------------------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------+
| clickable_id                          | dict(str:dict(RESULT_DICT)) | cookiebanner | Numerical id of the clicked clickables as string key. The value of the key are the extracted results after clicking the banner          |
+---------------------------------------+-----------------------------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------+

The detector modules
-----------------------------

General format of the detected cookie banner
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

The only difference in the result format is that the perceptive detection only saves **one** result while the other detection methods consider all possible matches, thus saving them in a list. During the banner analysis, the scanner only consideres the first match.

+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| Key                                  | Type            | Remarks                                                                            |
+======================================+=================+====================================================================================+
| clickables                           | list[CLICKABLE] | A list of all detected clickables in the banner                                    |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| fontsize                             | string          | Fontsize in px, e. g. "15px"                                                       |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| has_class                            | boolean         | Boolean that records whether the HTML tag of the detected banner has a HTML class  |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| has_id                               | boolean         | Boolen that records whether the HTML tag of the detected banner has an id          |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| height                               | int             | The height of the banner in pixels as an integer value                             |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| html                                 | str             | The HTML of the banner as a string                                                 |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| id                                   | string          | The id of the HTML tag as a string                                                 |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| is_page_modal                        | boolean         | Boolean that records whether the banner is modal                                   |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| language                             | str             | ISO language code of the banner                                                    |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| node_id                              | int             | ID of the HTML node of the banner as an integer.                                   |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| text                                 | str             | The text of the banner without any HTML                                            |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| width                                | int             | The width of the banner in pixels as an integer value                              |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| x                                    | int             | The x position of the banner                                                       |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| y                                    | int             | The y position of the banner                                                       |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+

The CLICKABLE object
^^^^^^^^^^^^^^^^^^^^

+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| Key                                  | Type            | Remarks                                                                            |
+======================================+=================+====================================================================================+
| backgroundColor                      | str             | color as a RGB string rgb(255,255,255)                                             |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| checked                              | boolean         | Boolean that records whether a checkbox has been checke                            |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| fontsize                             | string          | Fontsize in px, e. g. "15px"                                                       |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| height                               | int             | The height of the clickable in pixels as an integer value                          |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| href                                 | str             | URL if the clickable is a link                                                     |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| html                                 | int             | The id of the HTML tag of the clickable as an integer                              |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| is_visible                           | boolean         | Boolean that records whether the clickable is modal                                |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| node_id                              | int             | ID of the HTML node of the clickable as an integer                                 |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| role                                 | str             | Not used.                                                                          |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| text                                 | str             | The text of the clickable without any HTML                                         |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| type                                 | str             | The type of the clickable (e. g. "button", "checkbox" or "link")                   |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| width                                | int             | The width of the clickable in pixels as an integer value                           |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| x                                    | int             | The x position of the clickable                                                    |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| y                                    | int             | The y position of the clickable                                                    |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+

The extractor modules
-----------------------------

The COOKIE object
^^^^^^^^^^^^^^^^^

Only cookies that could potentially be used to identify a user are saved under the key "id_cookies" in the dictionary.

+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| Key                                  | Type            | Remarks                                                                            |
+======================================+=================+====================================================================================+
| domain                               | str             | The domain name for which the cookie is valid                                      |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| expires                              | float           | Time until the cookie expires in seconds                                           |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| httpOnly                             | boolean         | Boolean whether the website is http only (usaually "False")                        |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| name                                 | str             | The name of the cookie                                                             |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| path                                 | str             | The path for which the cookie is valid (usually "/")                               |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| priority                             | str             | Priority of the cookie. Usually "MEDIUM"                                           |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| sameParty                            | boolean         | Boolean whether the cookie is a same party cookie                                  |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| sourceScheme                         | boolean         | Usually "Secure" for https                                                         |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| session                              | boolean         | Boolean whether the cookie is a session cookie                                     |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| size                                 | int             | Size of the cookie in bytes                                                        |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| sourcePort                           | int             | The port of the visited website (usually 443 for https)                            |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| sourceScheme                         | str             | Channel through wich the cookie has been set (usually "Secure" for https)          |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| value                                | str             | The value of the cookie                                                            |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| zxcvbn                               | float           | Strength estimation via zxcvbn (log10 of guesses)                                  |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+

The COOKIE_SYNC object
^^^^^^^^^^^^^^^^^^^^^^
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| Key                                  | Type            | Remarks                                                                            |
+======================================+=================+====================================================================================+
| cookie_value                         | str             | The value of the synced cookie                                                     |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| sync_domain                          | float           | The domain to which the cookie is synced                                           |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| sync_request                         | boolean         | The synchronization request taht contains the cookie value                         |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| zxcvbn                               | str             | Strength estimation via zxcvbn (log10 of guesses)                                  |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+

The PRIVACY_POLICY object
^^^^^^^^^^^^^^^^^^^^^^^^^
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| Key                                  | Type            | Remarks                                                                            |
+======================================+=================+====================================================================================+
| html                                 | str             | The html code of the privacy policy page                                           |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| text                                 | str             | The text of the privacy policy page                                                |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| word_count                           | int             | The word count of the privacy policy page                                          |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+

The DISCONNECT_TRACKER object
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| Key                                  | Type            | Remarks                                                                            |
+======================================+=================+====================================================================================+
| tracker                              | TRACKER         | The tracker object                                                                 |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| url                                  | REQUEST         | The REQUEST object (see "resultdict.rst"), url is mostly important                 |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+

The TRACKER object
##################
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| Key                                  | Type            | Remarks                                                                            |
+======================================+=================+====================================================================================+
| catagory                             | str             | The category of the tracker, e. g. "FingerprintingGeneral"                         |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| company                              | str             | The company of the tracker                                                         |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| company_url                          | str             | The url of the tracking company                                                    |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
| domain                               | str             | The domain of the tracking request                                                 |
+--------------------------------------+-----------------+------------------------------------------------------------------------------------+
